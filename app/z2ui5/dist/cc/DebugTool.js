sap.ui.define(["sap/ui/core/Control","sap/ui/core/Fragment","sap/ui/model/json/JSONModel"],(e,t,s)=>{"use strict";return e.extend("z2ui5.cc.DebugTool",{prettifyXml:function(e){const t=(new DOMParser).parseFromString(e,"application/xml");var s=`&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;\n                &lt;xsl:strip-space elements="*" /&gt;\n                &lt;xsl:template match="para[content-style][not(text())]"&gt;\n                    &lt;xsl:value-of select="normalize-space(.)" /&gt;\n                &lt;/xsl:template&gt;\n                &lt;xsl:template match="node()|@*"&gt;\n                    &lt;xsl:copy&gt;\n                        &lt;xsl:apply-templates select="node()|@*" /&gt;\n                    &lt;/xsl:copy&gt;\n                &lt;/xsl:template&gt;\n                &lt;xsl:output indent="yes" /&gt;\n            &lt;/xsl:stylesheet&gt;`;s=s.replace(/&gt;/g,unescape("%3E")).replace(/&lt;/g,unescape("%3C"));const o=(new DOMParser).parseFromString(s,"application/xml");const i=new XSLTProcessor;i.importStylesheet(o);const n=i.transformToDocument(t);const l=(new XMLSerializer).serializeToString(n);return l.replace(/&gt;/g,">").replace(/&lt;/g,"<")},onItemSelect:function(e){const t=e.getSource().getSelectedKey();const s=z2ui5?.oView;const o=z2ui5?.oResponse;const i=this.displayEditor.bind(this);switch(t){case"CONFIG":i(e,JSON.stringify(z2ui5.oConfig,null,3),"json");break;case"MODEL":i(e,JSON.stringify(s?.getModel()?.getData(),null,3),"json");break;case"VIEW":const t=s?.mProperties?.viewContent||z2ui5.responseData.S_FRONT.PARAMS.S_VIEW.XML;i(e,this.prettifyXml(t),"xml",this.prettifyXml(s?._xContent.outerHTML));break;case"PLAIN":i(e,JSON.stringify(z2ui5.responseData,null,3),"json");break;case"REQUEST":i(e,JSON.stringify(z2ui5.oBody,null,3),"json");break;case"POPUP":i(e,this.prettifyXml(o?.PARAMS?.S_POPUP?.XML),"xml");break;case"POPUP_MODEL":i(e,JSON.stringify(z2ui5.oViewPopup.getModel().getData(),null,3),"json");break;case"POPOVER":i(e,this.prettifyXml(o?.PARAMS?.S_POPOVER?.XML),"xml");break;case"POPOVER_MODEL":i(e,JSON.stringify(z2ui5?.oViewPopover?.getModel()?.getData(),null,3),"json");break;case"NEST1":i(e,this.prettifyXml(z2ui5?.oViewNest?.mProperties?.viewContent),"xml",this.prettifyXml(z2ui5?.oViewNest?._xContent.outerHTML));break;case"NEST1_MODEL":i(e,JSON.stringify(z2ui5?.oViewNest?.getModel()?.getData(),null,3),"json");break;case"NEST2":i(e,this.prettifyXml(z2ui5?.oViewNest2?.mProperties?.viewContent),"xml",this.prettifyXml(z2ui5?.oViewNest2?._xContent.outerHTML));break;case"NEST2_MODEL":i(e,JSON.stringify(z2ui5?.oViewNest2?.getModel()?.getData(),null,3),"json");break;case"SOURCE":const n=e.getSource().getParent();const l=n.getContent()[2].getItems()[0];const a=`${window.location.origin}/sap/bc/adt/oo/classes/${z2ui5.responseData.S_FRONT.APP}/source/main`;const r=atob("PGlmcmFtZSBpZD0idGVzdCIgc3JjPSInICsgdXJsICsgJyIgaGVpZ2h0PSI4MDBweCIgd2lkdGg9IjEyMDBweCIgLz4=").replace("' + url + '",a);l.setProperty("content",r);const c=e.getSource().getModel().oData;c.editor_visible=false;c.source_visible=true;e.getSource().getModel().refresh();break}},displayEditor:function(e,t,s,o=""){const i=e.getSource().getModel().oData;i.editor_visible=true;i.source_visible=false;i.isTemplating=t.includes("xmlns:template");i.value=t;i.previousValue=t;i.xContent=o;i.type=s;e.getSource().getModel().refresh()},onTemplatingPress:function(e){const t=e.getSource().getModel().oData;t.value=e.getSource().getPressed()?t.xContent:t.previousValue;e.getSource().getModel().refresh()},onClose:function(){this.close()},async show(){if(!this.oDialog){this.oDialog=await t.load({name:"z2ui5.cc.DebugTool",controller:this})}const e=JSON.stringify(z2ui5.responseData,null,3);const o={type:"json",source_visible:false,editor_visible:true,value:e,xContent:"",previousValue:e,isTemplating:false,templatingSource:false,activeNest1:z2ui5?.oViewNest?.mProperties?.viewContent!==undefined,activeNest2:z2ui5?.oViewNest2?.mProperties?.viewContent!==undefined,activePopup:z2ui5?.oResponse?.PARAMS?.S_POPUP?.XML!==undefined,activePopover:z2ui5?.oResponse?.PARAMS?.S_POPOVER?.XML!==undefined};const i=new s(o);this.oDialog.addStyleClass("dbg-ltr");this.oDialog.setModel(i);this.oDialog.open()},async close(){if(this.oDialog){this.oDialog.close();this.oDialog.destroy();this.oDialog=null}},async toggle(){if(this.oDialog){this.close()}else{this.show()}},renderer(){}})});
//# sourceMappingURL=DebugTool.js.map
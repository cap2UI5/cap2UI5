sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/mvc/XMLView","sap/ui/model/json/JSONModel","sap/ui/core/BusyIndicator","sap/m/MessageBox","sap/m/MessageToast","sap/ui/core/Fragment","sap/m/BusyDialog","sap/ui/VersionInfo","z2ui5/cc/Server","sap/ui/model/odata/v2/ODataModel","sap/m/library","sap/ui/core/routing/HashChanger"],function(e,o,i,t,s,r,a,n,u,l,p,c,d){"use strict";return e.extend("z2ui5.controller.View1",{onInit(){z2ui5.oRouter.attachRouteMatched(function(e){z2ui5.checkInit=true;l.Roundtrip()},this)},async onAfterRendering(){if(!z2ui5.oResponse){return}try{if(!z2ui5.oResponse.PARAMS){t.hide();z2ui5.isBusy=false;return}const{S_POPUP:e,S_VIEW_NEST:o,S_VIEW_NEST2:i,S_POPOVER:s,SET_APP_STATE_ACTIVE:r,SET_PUSH_STATE:a,SET_NAV_BACK:n}=z2ui5.oResponse.PARAMS;if(e?.CHECK_DESTROY){z2ui5.oController.PopupDestroy()}if(s?.CHECK_DESTROY){z2ui5.oController.PopoverDestroy()}if(e?.XML){z2ui5.oController.PopupDestroy();await this.displayFragment(e.XML,"oViewPopup")}if(!z2ui5.checkNestAfter){if(o?.XML){z2ui5.oController.NestViewDestroy();await this.displayNestedView(o.XML,"oViewNest","S_VIEW_NEST");z2ui5.checkNestAfter=true}}if(!z2ui5.checkNestAfter2){if(i?.XML){z2ui5.oController.NestViewDestroy2();await this.displayNestedView2(i.XML,"oViewNest2","S_VIEW_NEST2");z2ui5.checkNestAfter2=true}}if(s?.XML){await this.displayPopover(s.XML,"oViewPopover",s.OPEN_BY_ID)}let u=JSON.parse(JSON.stringify({view:z2ui5.oView.mProperties.viewContent,model:z2ui5.oView.getModel().getData(),response:z2ui5.oResponse}));if(a){let e=new URL(window.location.href);let o=d.getInstance().getHash();if(!o){o="#"}history.pushState(u,"",e.pathname+e.search+o+a)}else{history.replaceState(u,"",window.location.href)}if(r){d.getInstance().replaceHash("z2ui5-xapp-state="+z2ui5.oResponse.ID)}else{d.getInstance().replaceHash("")}if(n){history.back()}z2ui5.onAfterRendering.forEach(e=>{if(e!==undefined){e()}});t.hide();z2ui5.isBusy=false}catch(e){t.hide();z2ui5.isBusy=false;s.error(e.toLocaleString(),{title:"Unexpected Error Occured - App Terminated",actions:[],onClose:()=>{new n({text:"Please Restart the App"}).open()}})}},async displayFragment(e,o){let t=new i(z2ui5.oResponse.OVIEWMODEL);const s=await a.load({definition:e,controller:z2ui5.oControllerPopup,id:"popupId"});s.setModel(t);z2ui5[o]=s;z2ui5[o].Fragment=a;s.open()},async displayPopover(e,o,t){sap.ui.require(["sap/ui/core/Element"],async function(s){const r=await a.load({definition:e,controller:z2ui5.oControllerPopover,id:"popoverId"});let n=new i(z2ui5.oResponse.OVIEWMODEL);r.setModel(n);z2ui5[o]=r;z2ui5[o].Fragment=a;let u={};if(z2ui5.oView?.byId(t)){u=z2ui5.oView.byId(t)}else if(z2ui5.oViewPopup?.Fragment.byId("popupId",t)){u=z2ui5.oViewPopup.Fragment.byId("popupId",t)}else if(z2ui5.oViewNest?.byId(t)){u=z2ui5.oViewNest.byId(t)}else if(z2ui5.oViewNest2?.byId(t)){u=z2ui5.oViewNest2.byId(t)}else{if(s.getElementById(t)){u=s.getElementById(t)}else{u=null}}r.openBy(u)})},async displayNestedView(e,t,s){let r=new i(z2ui5.oResponse.OVIEWMODEL);const a=await o.create({definition:e,controller:z2ui5.oControllerNest,preprocessors:{xml:{models:{template:r}}}});a.setModel(r);let n=z2ui5.oView.byId(z2ui5.oResponse.PARAMS[s].ID);if(n){try{n[z2ui5.oResponse.PARAMS[s].METHOD_DESTROY]()}catch{}n[z2ui5.oResponse.PARAMS[s].METHOD_INSERT](a)}z2ui5[t]=a},async displayNestedView2(e,t,s){let r=new i(z2ui5.oResponse.OVIEWMODEL);const a=await o.create({definition:e,controller:z2ui5.oControllerNest2,preprocessors:{xml:{models:{template:r}}}});a.setModel(r);let n=z2ui5.oView.byId(z2ui5.oResponse.PARAMS[s].ID);if(n){try{n[z2ui5.oResponse.PARAMS[s].METHOD_DESTROY]()}catch{}n[z2ui5.oResponse.PARAMS[s].METHOD_INSERT](a)}z2ui5[t]=a},PopupDestroy(){if(!z2ui5.oViewPopup){return}if(z2ui5.oViewPopup.close){try{z2ui5.oViewPopup.close()}catch{}}z2ui5.oViewPopup.destroy()},PopoverDestroy(){if(!z2ui5.oViewPopover){return}if(z2ui5.oViewPopover.close){try{z2ui5.oViewPopover.close()}catch{}}z2ui5.oViewPopover.destroy()},NestViewDestroy(){if(!z2ui5.oViewNest){return}z2ui5.oViewNest.destroy()},NestViewDestroy2(){if(!z2ui5.oViewNest2){return}z2ui5.oViewNest2.destroy()},ViewDestroy(){if(!z2ui5.oView){return}z2ui5.oView.destroy()},eF(...e){z2ui5.onBeforeEventFrontend.forEach(o=>{if(o!==undefined){o(e)}});let o;switch(e[0]){case"SET_SIZE_LIMIT":switch(e[2]){case"MAIN":z2ui5.oView.getModel().setSizeLimit(parseInt(e[1]));z2ui5.oView.getModel().refresh(true);break;case"NEST":z2ui5.oViewNest.getModel().setSizeLimit(parseInt(e[1]));z2ui5.oViewNest.getModel().refresh(true);break;case"NEST2":z2ui5.oViewNest2.getModel().setSizeLimit(parseInt(e[1]));z2ui5.oViewNest2.getModel().refresh(true);break;case"POPUP":z2ui5.oPopup.getModel().setSizeLimit(parseInt(e[1]));z2ui5.oPopup.getModel().refresh(true);break;case"POPOVER":z2ui5.oPopover.getModel().setSizeLimit(parseInt(e[1]));z2ui5.oPopover.getModel().refresh(true);break}break;case"HISTORY_BACK":history.back();break;case"CLIPBOARD_APP_STATE":function l(e){if(navigator.clipboard&&typeof navigator.clipboard.writeText==="function"){navigator.clipboard.writeText(e).then(()=>{}).catch(e=>{})}else{const o=document.createElement("textarea");o.value=e;document.body.appendChild(o);o.select();try{document.execCommand("copy")}catch(e){}document.body.removeChild(o)}}l(window.location.href+"#/z2ui5-xapp-state="+z2ui5.oResponse.ID);break;case"SET_ODATA_MODEL":var i=new p({serviceUrl:e[1],annotationURI:e.length>3?e[3]:""});z2ui5.oView.setModel(i,e[2]?e[2]:undefined);break;case"DOWNLOAD_B64_FILE":var t=document.createElement("a");t.href=e[1];t.download=e[2];t.click();break;case"CROSS_APP_NAV_TO_PREV_APP":sap.ui.require(["sap/ushell/Container"],async e=>{if(e){z2ui5.oCrossAppNavigator=e.getService("CrossApplicationNavigation")}else{z2ui5.oCrossAppNavigator=sap.ushell.Container.getService("CrossApplicationNavigation")}z2ui5.oCrossAppNavigator.backToPreviousApp()});break;case"CROSS_APP_NAV_TO_EXT":z2ui5.args=e;sap.ui.require(["sap/ushell/Container"],async e=>{if(e){z2ui5.oCrossAppNavigator=e.getService("CrossApplicationNavigation")}else{z2ui5.oCrossAppNavigator=sap.ushell.Container.getService("CrossApplicationNavigation")}const o=z2ui5.oCrossAppNavigator.hrefForExternal({target:z2ui5.args[1],params:z2ui5.args[2]})||"";if(z2ui5.args[3]==="EXT"){let e=window.location.href.split("#")[0]+o}else{z2ui5.oCrossAppNavigator.toExternal({target:{shellHash:o}})}});break;case"LOCATION_RELOAD":window.location=e[1];break;case"OPEN_NEW_TAB":window.open(e[1],"_blank");break;case"POPUP_CLOSE":z2ui5.oController.PopupDestroy();break;case"POPOVER_CLOSE":z2ui5.oController.PopoverDestroy();break;case"NAV_CONTAINER_TO":var s=z2ui5.oView.byId(e[1]);var r=z2ui5.oView.byId(e[2]);s.to(r);break;case"NEST_NAV_CONTAINER_TO":s=z2ui5.oViewNest.byId(e[1]);r=z2ui5.oViewNest.byId(e[2]);s.to(r);break;case"NEST2_NAV_CONTAINER_TO":s=z2ui5.oViewNest2.byId(e[1]);r=z2ui5.oViewNest2.byId(e[2]);s.to(r);break;case"POPUP_NAV_CONTAINER_TO":s=a.byId("popupId",e[1]);r=a.byId("popupId",e[2]);s.to(r);break;case"POPOVER_NAV_CONTAINER_TO":s=a.byId("popoverId",e[1]);r=a.byId("popoverId",e[2]);s.to(r);break;case"URLHELPER":var n=c.URLHelper;var u=e[2];switch(e[1]){case"REDIRECT":n.redirect(u.URL,u.NEW_WINDOW);break;case"TRIGGER_EMAIL":n.triggerEmail(u.EMAIL,u.SUBJECT,u.BODY,u.CC,u.BCC,u.NEW_WINDOW);break;case"TRIGGER_SMS":n.triggerSms(u);break;case"TRIGGER_TEL":n.triggerTel(u);break}break}},eB(...e){if(!window.navigator.onLine){s.alert("No internet connection! Please reconnect to the server and try again.");return}if(z2ui5.isBusy==true){if(!e[0][2]){let e=new n;e.open();setTimeout(e=>{e.close()},100,e);return}}z2ui5.isBusy=true;t.show();z2ui5.oBody={};if(e[0][3]||z2ui5.oController==this){if(z2ui5.oResponse.PARAMS.S_VIEW?.SWITCH_DEFAULT_MODEL_PATH){var o=z2ui5.oView.getModel("http")}else{o=z2ui5.oView.getModel()}z2ui5.oBody.XX=o.getData().XX;z2ui5.oBody.VIEWNAME="MAIN"}else if(z2ui5.oControllerPopup==this){if(z2ui5.oViewPopup){z2ui5.oBody.XX=z2ui5.oViewPopup.getModel().getData().XX}z2ui5.oBody.VIEWNAME="MAIN"}else if(z2ui5.oControllerPopover==this){z2ui5.oBody.XX=z2ui5.oViewPopover.getModel().getData().XX;z2ui5.oBody.VIEWNAME="MAIN"}else if(z2ui5.oControllerNest==this){z2ui5.oBody.XX=z2ui5.oViewNest.getModel().getData().XX;z2ui5.oBody.VIEWNAME="NEST"}else if(z2ui5.oControllerNest2==this){z2ui5.oBody.XX=z2ui5.oViewNest2.getModel().getData().XX;z2ui5.oBody.VIEWNAME="NEST2"}z2ui5.onBeforeRoundtrip.forEach(e=>{if(e!==undefined){e()}});z2ui5.oBody.ID=z2ui5.oResponse.ID;z2ui5.oBody.ARGUMENTS=e;z2ui5.oBody.ARGUMENTS.forEach((e,o)=>{if(o==0){return}if(typeof e==="object"){z2ui5.oBody.ARGUMENTS[o]=JSON.stringify(e)}});z2ui5.oResponseOld=z2ui5.oResponse;l.Roundtrip()},updateModelIfRequired(e,o){if(z2ui5.oResponse.PARAMS==undefined){return}if(z2ui5.oResponse.PARAMS[e]?.CHECK_UPDATE_MODEL){let e=new i(z2ui5.oResponse.OVIEWMODEL);if(o){o.setModel(e)}}},async checkSDKcompatibility(e){let o=await u.load();var i=o.gav.includes("com.sap.ui5")?true:false;if(!i){if(e){s.error("openui5 SDK is loaded, module: "+e._modules+" is not availabe in openui5");return}}s.error(e.toLocaleString())},showMessage(e,o){if(o==undefined){return}if(o[e]?.TEXT!==undefined){if(e==="S_MSG_TOAST"){r.show(o[e].TEXT,{duration:o[e].DURATION?parseInt(o[e].DURATION):3e3,width:o[e].WIDTH?o[e].WIDTH:"15em",onClose:o[e].ONCLOSE?o[e].ONCLOSE:null,autoClose:o[e].AUTOCLOSE?true:false,animationTimingFunction:o[e].ANIMATIONTIMINGFUNCTION?o[e].ANIMATIONTIMINGFUNCTION:"ease",animationDuration:o[e].ANIMATIONDURATION?parseInt(o[e].ANIMATIONDURATION):1e3,closeonBrowserNavigation:o[e].CLOSEONBROWSERNAVIGATION?true:false});if(o[e].CLASS){let i={};i=document.getElementsByClassName("sapMMessageToast")[0];if(i){i.classList.add(o[e].CLASS)}}}else if(e==="S_MSG_BOX"){let i={styleClass:o[e].STYLECLASS?o[e].STYLECLASS:"",title:o[e].TITLE?o[e].TITLE:"",onClose:o[e].ONCLOSE?Function("sAction","return "+o[e].ONCLOSE):null,actions:o[e].ACTIONS?o[e].ACTIONS:"OK",emphasizedAction:o[e].EMPHASIZEDACTION?o[e].EMPHASIZEDACTION:"OK",initialFocus:o[e].INITIALFOCUS?o[e].INITIALFOCUS:null,textDirection:o[e].TEXTDIRECTION?o[e].TEXTDIRECTION:"Inherit",icon:o[e].ICON?o[e].ICON:"NONE",details:o[e].DETAILS?o[e].DETAILS:"",closeOnNavigation:o[e].CLOSEONNAVIGATION?true:false};if(i.icon="None"){delete i.icon}s[o[e].TYPE](o[e].TEXT,i)}}},async displayView(e,t){let s=new i(t);var r=s;if(z2ui5.oResponse.PARAMS.S_VIEW?.SWITCH_DEFAULT_MODEL_PATH){r=new p({serviceUrl:z2ui5.oResponse.PARAMS.S_VIEW?.SWITCH_DEFAULT_MODEL_PATH,annotationURI:z2ui5.oResponse.PARAMS.S_VIEW?.SWITCHDEFAULTMODELANNOURI})}z2ui5.oView=await o.create({definition:e,models:r,controller:z2ui5.oController,id:"mainView",preprocessors:{xml:{models:{template:s}}}});z2ui5.oView.setModel(z2ui5.oDeviceModel,"device");if(z2ui5.oResponse.PARAMS.S_VIEW?.SWITCH_DEFAULT_MODEL_PATH){z2ui5.oView.setModel(s,"http")}z2ui5.oApp.removeAllPages();z2ui5.oApp.insertPage(z2ui5.oView)}})});
//# sourceMappingURL=View1.controller.js.map